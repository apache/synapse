<definitions xmlns="http://ws.apache.org/ns/synapse">

    <!-- Introduction to the script mediator with Ruby scripts-->

    <!-- define a static property for the JRuby source code file -->
    <localEntry key="stockquoteScript">
	<address  src="file:repository/conf/sample/resources/script/stockquoteTransform.rb"/>
    </localEntry>

    <!-- define a reuseable endpoint definition and use it within config -->
    <endpoint name="stockquote">
	<address  uri="http://localhost:9000/axis2/services/SimpleStockQuoteService"/>
    </endpoint>	
    

    <in>
            <!-- transform the custom quote request into a standard quote request expected by the service -->
            <script language="rb" key="stockquoteScript" function="transformRequest"/>

            <!-- send message to real endpoint referenced by name "stockquote" and stop -->
            <send>
                <endpoint key="stockquote"/>
            </send>
    </in>

    <out>
            <!-- transform the standard response back into the custom format the client expects -->
            <script language="rb" key="stockquoteScript" function="transformResponse"/>

            <!-- now send the custom response back to the client and stop -->
            <send/>
    </out>
    

</definitions> 
